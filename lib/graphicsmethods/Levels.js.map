{"version":3,"sources":["../../src/graphicsmethods/Levels.jsx"],"names":["NOP","verify","value","match","Number","parseFloat","handleChange","event","i","parseInt","target","name","split","cur_value","levels","state","first","slice","concat","setState","length","Levels","createClass","propTypes","addLevel","PropTypes","func","removeLevel","array","getInitialState","componentWillReceiveProps","nextProps","cur_gmProps","Object","assign","props","gmProps","updateActiveGM","graphicsMethodParent","graphicsMethod","index","getAttribute","cur_levels","new_levels","handleBlur","property_name","$","focus","render","usage","map","isInteger","Math","abs","toExponential","bind"],"mappings":";;;;;;AACA;;;;AACA;;;;;;AAFA;AAGA,IAAIA,MAAM,SAANA,GAAM,GAAI,CAAE,CAAhB;;AAEA,SAASC,MAAT,CAAgBC,KAAhB,EAAuB;AACnB,QAAI,OAAOA,KAAP,KAAkB,QAAtB,EAAgC;AAC5B,YAAGA,MAAMC,KAAN,CAAY,wCAAZ,CAAH,EAA0D;AACtD,mBAAOC,OAAOC,UAAP,CAAkBH,KAAlB,CAAP;AACH,SAFD,MAEO;AACH,mBAAO,KAAP;AACH;AACJ;AACJ;AACD,SAASI,YAAT,CAAsBC,KAAtB,EAA6B;AACzB,QAAIC,IAAIJ,OAAOK,QAAP,CAAgBF,MAAMG,MAAN,CAAaC,IAAb,CAAkBC,KAAlB,CAAwB,GAAxB,EAA6B,CAA7B,CAAhB,CAAR;AACA,QAAIC,YAAYN,MAAMG,MAAN,CAAaR,KAA7B;AACA,QAAIY,SAAS,KAAKC,KAAL,CAAWD,MAAxB;AACA,QAAIE,QAAQF,OAAOG,KAAP,CAAa,CAAb,EAAgBT,CAAhB,EAAmBU,MAAnB,CAA0BL,SAA1B,CAAZ;AACA,SAAKM,QAAL,CAAc;AACVL,gBAAQE,MAAME,MAAN,CAAaJ,OAAOG,KAAP,CAAcT,IAAI,CAAlB,EAAsBM,OAAOM,MAA7B,CAAb;AADE,KAAd;AAGH;AACD,IAAIC,SAAS,gBAAMC,WAAN,CAAkB;AAAA;;AAC3BC,eAAW;AACPC,kBAAU,gBAAMC,SAAN,CAAgBC,IADnB;AAEPC,qBAAa,gBAAMF,SAAN,CAAgBC,IAFtB;AAGPpB,sBAAc,gBAAMmB,SAAN,CAAgBC,IAHvB;AAIPZ,gBAAQ,gBAAMW,SAAN,CAAgBG;AAJjB,KADgB;AAO3BC,mBAP2B,6BAOT;AACd,eAAO;AACHf,oBAAQ;AADL,SAAP;AAGH,KAX0B;AAY3BgB,6BAZ2B,qCAYDC,SAZC,EAYU;AACjC,aAAKZ,QAAL,CAAc;AACVL,oBAAQiB,UAAUjB;AADR,SAAd;AAGH,KAhB0B;AAiB3BU,YAjB2B,sBAiBhB;AACP,YAAIQ,cAAcC,OAAOC,MAAP,CAAc,EAAd,EAAkB,KAAKC,KAAL,CAAWC,OAA7B,CAAlB;AACAJ,oBAAY,QAAZ,IAAwBA,YAAY,QAAZ,EAAsBd,MAAtB,CAA6B,KAA7B,CAAxB;AACA,aAAKiB,KAAL,CAAWE,cAAX,CAA0BL,WAA1B,EAAuC,KAAKG,KAAL,CAAWG,oBAAlD,EAAwE,KAAKH,KAAL,CAAWI,cAAnF;AACH,KArB0B;AAsB3BZ,eAtB2B,uBAsBfpB,KAtBe,EAsBR;AACf,YAAIiC,QAAQpC,OAAOK,QAAP,CAAgBF,MAAMG,MAAN,CAAa+B,YAAb,CAA0B,YAA1B,CAAhB,CAAZ;AACA,YAAIT,cAAcC,OAAOC,MAAP,CAAc,EAAd,EAAkB,KAAKC,KAAL,CAAWC,OAA7B,CAAlB;AACA,YAAIM,aAAaV,YAAY,QAAZ,CAAjB;AACA,YAAIW,aAAaD,WAAWzB,KAAX,CAAiB,CAAjB,EAAoBuB,KAApB,EAA2BtB,MAA3B,CAAkCwB,WAAWzB,KAAX,CAAkBuB,QAAQ,CAA1B,EAA8BE,WAAWtB,MAAzC,CAAlC,CAAjB;AACAY,oBAAY,QAAZ,IAAwBW,UAAxB;AACA,aAAKR,KAAL,CAAWE,cAAX,CAA0BL,WAA1B,EAAuC,KAAKG,KAAL,CAAWG,oBAAlD,EAAwE,KAAKH,KAAL,CAAWI,cAAnF;AACH,KA7B0B;AA8B3BK,cA9B2B,sBA8BhBrC,KA9BgB,EA8BT;AACd,YAAIsC,gBAAgBtC,MAAMG,MAAN,CAAaC,IAAb,CAAkBC,KAAlB,CAAwB,GAAxB,EAA6B,CAA7B,CAApB;AACA,YAAI4B,QAAQjC,MAAMG,MAAN,CAAaC,IAAb,CAAkBC,KAAlB,CAAwB,GAAxB,EAA6B,CAA7B,CAAZ;AACA,YAAIV,QAAQD,OAAOM,MAAMG,MAAN,CAAaR,KAApB,CAAZ;AACA,YAAIA,UAAU,CAAV,IAAeA,KAAnB,EAA0B;AACtB,iBAAKiC,KAAL,CAAW7B,YAAX,CAAwBuC,aAAxB,EAAuC3C,KAAvC,EAA8CsC,KAA9C;AACH,SAFD,MAEO;AACH,iBAAKrB,QAAL,CAAc;AACVL,wBAAQ,KAAKqB,KAAL,CAAWrB;AADT,aAAd;AAGAgC,cAAE,aAAWN,KAAX,GAAiB,QAAnB,EAA6BO,KAA7B;AACH;AACJ,KA1C0B;AA2C3BC,UA3C2B,oBA2CnB;AAAA;;AACJ,YAAIC,QAAS,sDACD,sDADZ;AAEA,eACI;AAAA;AAAA;AACI;AAAA;AAAA;AAAA;AAAA,aADJ;AAGQ,iBAAKlC,KAAL,CAAWD,MAAX,IAAqB,KAAKC,KAAL,CAAWD,MAAX,CAAkBM,MAAlB,GAA2B,CAAhD,GACE,KAAKL,KAAL,CAAWD,MAAX,CAAkBoC,GAAlB,CAAsB,UAAChD,KAAD,EAAQsC,KAAR,EAAkB;AACtC,uBACI;AAAA;AAAA,sBAAK,KAAK,YAAUA,KAApB;AACI,6DAAO,MAAM,YAAUA,KAAvB;AACI,8BAAK,MADT;AAEI,+BACIpC,OAAO+C,SAAP,CAAiBjD,KAAjB,KAA2BkD,KAAKC,GAAL,CAASnD,KAAT,IAAkB,GAA7C,GACEA,MAAMoD,aAAN,EADF,GAEEpD,KALV;AAOI,kCAAUI,aAAaiD,IAAb,OAPd;AAQI,gCAAQ,MAAKX,UARjB,GADJ;AAUI;AAAA;AAAA,0BAAQ,SAAS,MAAKT,KAAL,CAAWR,WAA5B;AACI,0CAAYa,KADhB;AAEI,uCAAU,mBAFd;AAAA;AAAA,qBAVJ;AAeI,qEAAO,IAAI,YAAUA,KAAV,GAAgB,QAA3B;AACI,+BAAOS,KADX,GAfJ;AAgBwB,6DAhBxB;AAkBQT,8BAAW,MAAKzB,KAAL,CAAWD,MAAX,CAAkBM,MAAlB,GAA2B,CAAtC,GACE;AAAA;AAAA,0BAAQ,SAAS,MAAKe,KAAL,CAAWX,QAA5B;AACE,uCAAU,mBADZ;AAAA;AAAA,qBADF,GAKE;AAvBV,iBADJ;AA4BF,aA7BA,CADF,GA+BE;AAAA;AAAA;AACE;AAAA;AAAA,sBAAQ,SAAS,KAAKW,KAAL,CAAWX,QAA5B,EAAsC,WAAU,mBAAhD;AAAA;AAAA,iBADF;AAEE,iEAAO,IAAI,cAAX;AACI,2BAAO,aADX;AAFF;AAlCV,SADJ;AA4CH;AA1F0B,CAAlB,CAAb;;kBA6FeH,M","file":"Levels.js","sourcesContent":["/* global $ */\nimport React from 'react'\nimport Usage from '../Usage'\nvar NOP = ()=>{}\n\nfunction verify(value) {\n    if (typeof(value) === 'string') {\n        if(value.match(/^[\\+-]?[0-9]+((\\.[0-9]+)?e\\+?[0-9]+)?$/)) {\n            return Number.parseFloat(value);\n        } else {\n            return false;\n        }\n    }\n}\nfunction handleChange(event) {\n    let i = Number.parseInt(event.target.name.split('_')[1]);\n    let cur_value = event.target.value;\n    let levels = this.state.levels;\n    let first = levels.slice(0, i).concat(cur_value);\n    this.setState({\n        levels: first.concat(levels.slice((i + 1), levels.length))\n    })\n}\nvar Levels = React.createClass({\n    propTypes: {\n        addLevel: React.PropTypes.func,\n        removeLevel: React.PropTypes.func,\n        handleChange: React.PropTypes.func,\n        levels: React.PropTypes.array\n    },\n    getInitialState() {\n        return {\n            levels: [],\n        }\n    },\n    componentWillReceiveProps(nextProps) {\n        this.setState({\n            levels: nextProps.levels\n        })\n    },\n    addLevel() {\n        let cur_gmProps = Object.assign({}, this.props.gmProps);\n        cur_gmProps['levels'] = cur_gmProps['levels'].concat(1e+20);\n        this.props.updateActiveGM(cur_gmProps, this.props.graphicsMethodParent, this.props.graphicsMethod);\n    },\n    removeLevel(event) {\n        let index = Number.parseInt(event.target.getAttribute('data-index'));\n        let cur_gmProps = Object.assign({}, this.props.gmProps);\n        let cur_levels = cur_gmProps['levels'];\n        let new_levels = cur_levels.slice(0, index).concat(cur_levels.slice((index + 1), cur_levels.length));\n        cur_gmProps['levels'] = new_levels;\n        this.props.updateActiveGM(cur_gmProps, this.props.graphicsMethodParent, this.props.graphicsMethod);\n    },\n    handleBlur(event) {\n        let property_name = event.target.name.split('_')[0];\n        let index = event.target.name.split('_')[1];\n        let value = verify(event.target.value);\n        if (value === 0 || value) {\n            this.props.handleChange(property_name, value, index)\n        } else {\n            this.setState({\n                levels: this.props.levels\n            });\n            $('#levels-'+index+'-usage').focus()\n        }\n    },\n    render(){\n        let usage =  \"Set the level range to use. Must be an integer.\\n\" +\n                    \"If set to 1e+20, VCS will auto-allocate level value.\"\n        return (\n            <div >\n                <h5>Levels: </h5>\n                {\n                    this.state.levels && this.state.levels.length > 0\n                    ? this.state.levels.map((value, index) => {\n                        return (\n                            <div key={'levels_'+index}>\n                                <input name={'levels_'+index}\n                                    type=\"text\"\n                                    value={\n                                        Number.isInteger(value) && Math.abs(value) > 1e4\n                                        ? value.toExponential()\n                                        : value\n                                    }\n                                    onChange={handleChange.bind(this)}\n                                    onBlur={this.handleBlur}/>\n                                <button onClick={this.props.removeLevel}\n                                    data-index={index}\n                                    className='btn btn-secondary'>\n                                            -\n                                </button>\n                                <Usage id={'levels-'+index+'-usage'}\n                                    usage={usage} /><br/>\n                                {\n                                    index === (this.state.levels.length - 1)\n                                    ? <button onClick={this.props.addLevel}\n                                        className='btn btn-secondary'>\n                                        +\n                                      </button>\n                                    : ''\n                                }\n                            </div>\n                        );\n                     })\n                    : <span>\n                        <button onClick={this.props.addLevel} className='btn btn-secondary'> + </button>\n                        <Usage id={'levels-usage'}\n                            usage={\"Add a level\"} />\n                      </span>\n\n                }\n            </div>\n        );\n    }\n});\n\nexport default Levels;\n"]}