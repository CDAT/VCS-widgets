{"version":3,"sources":["../../src/graphicsmethods/GraphicsMethodEditForm.jsx"],"names":["new_name","that","graphicsMethods","gm","parent","name","state","gmEditName","i","GraphicsMethodEditForm","createClass","propTypes","colormaps","PropTypes","array","graphicsMethod","string","graphicsMethodParent","gmProps","object","updateGraphicsMethods","func","updateActiveGM","getInitialState","props","componentWillUpdate","prop","componentDidUpdate","componentWillReceiveProps","nextProps","setState","addLevel","cur_gmProps","Object","assign","concat","removeLevel","event","index","Number","parseInt","target","getAttribute","cur_levels","new_levels","slice","length","handleChange","property_name","type","checked","match","level_index","split","value","changeState","commitEdits","new_props","gm_name","gmEditNameChange","render","no_gm_selected"],"mappings":"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","file":"GraphicsMethodEditForm.js","sourcesContent":["import React from 'react'\nimport $ from 'jquery'\n\nlet new_name = (that, graphicsMethods, gm, parent) => {\n    let name = that.state.gmEditName ?that.state.gmEditName :gm;\n    let i;\n    // don't squash the base graphics methods\n    if (graphicsMethods['default_method']) {\n        i=0;\n        do {\n            ++i;\n        } while(graphicsMethods[parent][name+'__edit__'+i])\n        return (name+'__edit__'+i);\n    } else {\n        return name;\n    }\n};\nvar GraphicsMethodEditForm = React.createClass({\n    propTypes: {\n        colormaps: React.PropTypes.array,\n        graphicsMethod: React.PropTypes.string,\n        graphicsMethodParent: React.PropTypes.string,\n        gmProps: React.PropTypes.object,\n        graphicsMethods: React.PropTypes.object,\n        updateGraphicsMethods: React.PropTypes.func,\n        updateActiveGM: React.PropTypes.func\n    },\n    getInitialState() {\n        return {\n            gmEditName: this.props.graphicsMethod\n        }\n    },\n    componentWillUpdate() {\n        $(\"#commit-gm-edits\").prop(\"disabled\", true)\n    },\n    componentDidUpdate() {\n        $(\"#commit-gm-edits\").prop(\"disabled\", false)\n    },\n    componentWillReceiveProps(nextProps) {\n        this.setState({\n            gmEditName: nextProps.graphicsMethod\n        })\n\n    },\n    addLevel() {\n        let cur_gmProps = Object.assign({}, this.props.gmProps);\n        cur_gmProps['levels'] = cur_gmProps['levels'].concat(1e+20);\n        this.props.updateActiveGM(cur_gmProps, this.props.graphicsMethodParent, this.props.graphicsMethod);\n    },\n    removeLevel(event) {\n        let index = Number.parseInt(event.target.getAttribute('data-index'));\n        let cur_gmProps = Object.assign({}, this.props.gmProps);\n        let cur_levels = cur_gmProps['levels'];\n        let new_levels = cur_levels.slice(0, index).concat(cur_levels.slice((index + 1), cur_levels.length));\n        cur_gmProps['levels'] = new_levels;\n        this.props.updateActiveGM(cur_gmProps, this.props.graphicsMethodParent, this.props.graphicsMethod);\n    },\n    handleChange: function(event) {\n        let property_name = event.target.name;\n        let cur_gmProps = Object.assign({}, this.props.gmProps);\n        if (event.target.type === 'checkbox') {\n            cur_gmProps[property_name] = event.target.checked;\n        } else if (property_name.match(/levels_[0-9]+/)) {\n            let level_index = Number.parseInt(property_name.split('_')[1]);\n            cur_gmProps['levels'][level_index] = event.target.value;\n        } else {\n            cur_gmProps[property_name] = event.target.value;\n        }\n        this.props.updateActiveGM(cur_gmProps, this.props.graphicsMethodParent, this.props.graphicsMethod);\n    },\n    changeState(property_name, value, index=null) {\n        let cur_gmProps = Object.assign({}, this.props.gmProps);\n        if(!index) {\n            cur_gmProps[property_name] = value;\n        } else {\n            cur_gmProps[property_name][index] = value;\n        }\n        this.props.updateActiveGM(cur_gmProps, this.props.graphicsMethodParent, this.props.graphicsMethod);\n    },\n    commitEdits() {\n        let parent = this.props.graphicsMethodParent;\n        let gm = this.props.graphicsMethod;\n        let new_props = this.props.gmProps;\n        let graphicsMethods = this.props.graphicsMethods;\n        let gm_name = new_name(this, graphicsMethods, gm, parent)\n        this.props.updateGraphicsMethods(graphicsMethods, new_props, parent, gm, gm_name);\n        this.setState({\n            gmEditName: ''\n        });\n    },\n    gmEditNameChange(event) {\n        this.setState({\n            gmEditName: event.target.value\n        });\n    },\n    render() {\n        if (!this.props.gmProps.no_gm_selected) {\n            return(\n                <div>\n                    <div className='modal-body'>\n                        <BoxfillEditor addLevel={this.addLevel}\n                            changeState={this.changeState}\n                            colormaps={this.props.colormaps}\n                            gmProps={this.props.gmProps}\n                            gmEditName={this.state.gmEditName}\n                            gmEditNameChange={this.gmEditNameChange}\n                            handleChange={this.handleChange}\n                            removeLevel={this.removeLevel} />\n\n                    </div>\n                    <div className=\"modal-footer\">\n                        <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\n                        <button type=\"button\"\n                            className=\"btn btn-primary\"\n                            id=\"commit-gm-edits\"\n                            onClick={this.commitEdits}\n                            data-dismiss=\"modal\">\n                            Save changes\n                        </button>\n                    </div>\n                </div>\n            )\n        }\n        else {\n            return (\n                <div>\n                    <h5> Please select a Graphics Method to edit</h5>\n                </div>\n            )\n        }\n\n    }\n});\n\nexport default GraphicsMethodEditForm;\n"]}